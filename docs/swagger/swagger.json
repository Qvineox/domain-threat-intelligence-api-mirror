{
    "swagger": "2.0",
    "info": {
        "description": "API provided by DTI project",
        "title": "Domain Threat Intelligence API",
        "contact": {
            "name": "Yaroslav Lysak",
            "url": "https://t.me/Qvineox"
        },
        "version": "0.0.3"
    },
    "host": "localhost:7090",
    "basePath": "/api/v1",
    "paths": {
        "/blacklists/domain": {
            "get": {
                "description": "Returns list of blacklisted domains by filter",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Blacklisted domains by filter",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "integer"
                        },
                        "collectionFormat": "multi",
                        "description": "Source type IDs",
                        "name": "source_id",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Import event ID",
                        "name": "import_event_id",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Is active",
                        "name": "is_active",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Substring to search",
                        "name": "search_string",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Query limit",
                        "name": "limit",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Query offset",
                        "name": "offset",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/blacklistEntities.BlacklistedDomain"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            },
            "put": {
                "description": "Accepts and saves list of blacklisted domains",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Save blacklisted domains",
                "parameters": [
                    {
                        "description": "IPs to save",
                        "name": "hosts",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.blacklistInsertParams"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            },
            "delete": {
                "description": "Accepts and deletes single blacklisted domain",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Delete blacklisted domain",
                "parameters": [
                    {
                        "description": "record UUID to delete",
                        "name": "id",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.deleteByUUIDParams"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/email": {
            "get": {
                "description": "Returns list of blacklisted emails by filter",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Blacklisted emails by filter",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "integer"
                        },
                        "collectionFormat": "multi",
                        "description": "Source type IDs",
                        "name": "source_id",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Import event ID",
                        "name": "import_event_id",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Is active",
                        "name": "is_active",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Substring to search",
                        "name": "search_string",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Query limit",
                        "name": "limit",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Query offset",
                        "name": "offset",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/blacklistEntities.BlacklistedEmail"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            },
            "put": {
                "description": "Accepts and saves list of blacklisted emails",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Save blacklisted emails",
                "parameters": [
                    {
                        "description": "emails to save",
                        "name": "hosts",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.blacklistInsertParams"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            },
            "delete": {
                "description": "Accepts and deletes single blacklisted email",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Delete blacklisted email",
                "parameters": [
                    {
                        "description": "record UUID to delete",
                        "name": "id",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.deleteByUUIDParams"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/export/csv": {
            "post": {
                "description": "Accepts filters and returns exported blacklisted hosts in CSV",
                "produces": [
                    "application/json",
                    "application/csv"
                ],
                "tags": [
                    "Blacklists",
                    "Export"
                ],
                "summary": "Exports blacklisted hosts into CSV",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "integer"
                        },
                        "collectionFormat": "multi",
                        "description": "Source type IDs",
                        "name": "source_id",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Import event ID",
                        "name": "import_event_id",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Is active",
                        "name": "is_active",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Substring to search",
                        "name": "search_string",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "file"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/export/json": {
            "post": {
                "description": "Accepts filters and returns exported blacklisted hosts in JSON",
                "produces": [
                    "application/json",
                    "application/json"
                ],
                "tags": [
                    "Blacklists",
                    "Export"
                ],
                "summary": "Exports blacklisted hosts into JSON",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "integer"
                        },
                        "collectionFormat": "multi",
                        "description": "Source type IDs",
                        "name": "source_id",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Import event ID",
                        "name": "import_event_id",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Is active",
                        "name": "is_active",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Substring to search",
                        "name": "search_string",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "file"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/export/naumen": {
            "post": {
                "description": "Sends service call to Naumen Service Desk with hosts selected to block by filter",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists",
                    "Export"
                ],
                "summary": "Send hosts to Naumen Service Desk",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "integer"
                        },
                        "collectionFormat": "multi",
                        "description": "Source type IDs",
                        "name": "source_id",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Import event ID",
                        "name": "import_event_id",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Is active",
                        "name": "is_active",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Substring to search",
                        "name": "search_string",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/serviceDeskEntities.ServiceDeskTicket"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/host": {
            "get": {
                "description": "Returns list of blacklisted hosts (all types) by filter",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "All hosts by filter",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "integer"
                        },
                        "collectionFormat": "multi",
                        "description": "Source type IDs",
                        "name": "source_id[]",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Import event ID",
                        "name": "import_event_id",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Is active",
                        "name": "is_active",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "value to search",
                        "name": "search_string",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Query limit",
                        "name": "limit",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Query offset",
                        "name": "offset",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/blacklistEntities.BlacklistedHost"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/import/csv": {
            "post": {
                "description": "Accepts and imports blacklisted hosts from CSV file",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists",
                    "Import"
                ],
                "summary": "Import blacklisted hosts from CSV file",
                "parameters": [
                    {
                        "type": "file",
                        "description": "file to import",
                        "name": "file_upload",
                        "in": "formData",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "discovery date",
                        "name": "discovered_at",
                        "in": "formData",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "other types extraction",
                        "name": "extract_all",
                        "in": "formData",
                        "required": true
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/import/event": {
            "get": {
                "description": "Returns import events without data",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists",
                    "Import"
                ],
                "summary": "Get import events list",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Type to search",
                        "name": "type",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Query limit",
                        "name": "limit",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Query offset",
                        "name": "offset",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/import/event/{event_id}": {
            "get": {
                "description": "Returns import event data with all included blacklisted hosts",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists",
                    "Import"
                ],
                "summary": "Get import event",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "Event ID",
                        "name": "event_id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/import/events": {
            "delete": {
                "description": "Accepts and deletes single blacklist import event",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists",
                    "Import"
                ],
                "summary": "Delete blacklist import event",
                "parameters": [
                    {
                        "description": "record ID to delete",
                        "name": "id",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.deleteByIDParams"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/import/stix": {
            "post": {
                "description": "Accepts and imports blacklisted hosts from STIX 2.0 file",
                "consumes": [
                    "multipart/form-data"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists",
                    "Import"
                ],
                "summary": "Import blacklisted hosts from file (STIX 2.0)",
                "parameters": [
                    {
                        "type": "file",
                        "description": "file to import",
                        "name": "file_upload",
                        "in": "formData",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "discovery date",
                        "name": "discovered_at",
                        "in": "formData",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "other types extraction",
                        "name": "extract_all",
                        "in": "formData",
                        "required": true
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/ip": {
            "get": {
                "description": "Returns list of blacklisted IPs by filter",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Blacklisted IPs by filter",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "integer"
                        },
                        "collectionFormat": "multi",
                        "description": "Source type IDs",
                        "name": "source_id",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Import event ID",
                        "name": "import_event_id",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Is active",
                        "name": "is_active",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "CIDR to search (must include IP/MASK)",
                        "name": "search_string",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Query limit",
                        "name": "limit",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Query offset",
                        "name": "offset",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/blacklistEntities.BlacklistedIP"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            },
            "put": {
                "description": "Accepts and saves list of blacklisted IPs",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Save blacklisted ips",
                "parameters": [
                    {
                        "description": "IPs to save",
                        "name": "hosts",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.blacklistInsertParams"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            },
            "delete": {
                "description": "Accepts and deletes single blacklisted IP",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Delete blacklisted IP",
                "parameters": [
                    {
                        "description": "record UUID to delete",
                        "name": "id",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.deleteByUUIDParams"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/sources": {
            "get": {
                "description": "Returns all available blacklist data sources",
                "produces": [
                    "application/json",
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Get blacklist sources",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/blacklistEntities.BlacklistSource"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/stats": {
            "get": {
                "description": "Returns data containing overall amount of blacklisted entities",
                "produces": [
                    "application/json",
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Returns amount of blacklisted entities",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/routing.BlacklistedStatistics"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/blacklists/url": {
            "get": {
                "description": "Returns list of blacklisted URLs by filter",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Blacklisted URLs by filter",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "integer"
                        },
                        "collectionFormat": "multi",
                        "description": "Source type IDs",
                        "name": "source_id",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Import event ID",
                        "name": "import_event_id",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Is active",
                        "name": "is_active",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is after",
                        "name": "created_after",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Created timestamp is before",
                        "name": "created_before",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Substring to search",
                        "name": "search_string",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Query limit",
                        "name": "limit",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Query offset",
                        "name": "offset",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/blacklistEntities.BlacklistedURL"
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            },
            "put": {
                "description": "Accepts and saves list of blacklisted URLs",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Save blacklisted URLs",
                "parameters": [
                    {
                        "description": "URLs to save",
                        "name": "hosts",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.blacklistInsertParams"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            },
            "delete": {
                "description": "Accepts and deletes single blacklisted URL",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Blacklists"
                ],
                "summary": "Delete blacklisted URL",
                "parameters": [
                    {
                        "description": "record UUID to delete",
                        "name": "id",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.deleteByUUIDParams"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/success.DatabaseResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/system/dynamic": {
            "get": {
                "description": "Gets info about current dynamic application config",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Configuration"
                ],
                "summary": "View application dynamic config",
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        },
        "/system/dynamic/variable": {
            "post": {
                "description": "Updates dynamic application config variable",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Configuration"
                ],
                "summary": "Update dynamic config variable",
                "parameters": [
                    {
                        "description": "variable to update",
                        "name": "variable",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/routing.dynamicConfigUpdateParams"
                        }
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Accepted"
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/error.APIError"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "blacklistEntities.BlacklistImportEvent": {
            "type": "object",
            "properties": {
                "CreatedAt": {
                    "type": "string"
                },
                "DeletedAt": {
                    "$ref": "#/definitions/gorm.DeletedAt"
                },
                "ID": {
                    "type": "integer"
                },
                "IsComplete": {
                    "type": "boolean"
                },
                "Summary": {
                    "$ref": "#/definitions/datatypes.JSONType-blacklistEntities_BlacklistImportEventSummary"
                },
                "Type": {
                    "type": "string"
                }
            }
        },
        "blacklistEntities.BlacklistSource": {
            "type": "object",
            "properties": {
                "CreatedAt": {
                    "type": "string"
                },
                "DeletedAt": {
                    "$ref": "#/definitions/gorm.DeletedAt"
                },
                "Description": {
                    "type": "string"
                },
                "ID": {
                    "type": "integer"
                },
                "Name": {
                    "type": "string"
                },
                "UpdatedAt": {
                    "type": "string"
                }
            }
        },
        "blacklistEntities.BlacklistedDomain": {
            "type": "object",
            "properties": {
                "CreatedAt": {
                    "type": "string"
                },
                "DeletedAt": {
                    "$ref": "#/definitions/gorm.DeletedAt"
                },
                "Description": {
                    "type": "string"
                },
                "DiscoveredAt": {
                    "description": "DiscoveredAt sets date of discovery, provided by source or inserted automatically on create",
                    "type": "string"
                },
                "ImportEvent": {
                    "description": "ImportEvent describes import session from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                        }
                    ]
                },
                "ImportEventID": {
                    "type": "integer"
                },
                "Source": {
                    "description": "Defines source from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistSource"
                        }
                    ]
                },
                "SourceID": {
                    "type": "integer"
                },
                "URN": {
                    "type": "string"
                },
                "UUID": {
                    "type": "string"
                },
                "UpdatedAt": {
                    "type": "string"
                }
            }
        },
        "blacklistEntities.BlacklistedEmail": {
            "type": "object",
            "properties": {
                "CreatedAt": {
                    "type": "string"
                },
                "DeletedAt": {
                    "$ref": "#/definitions/gorm.DeletedAt"
                },
                "Description": {
                    "type": "string"
                },
                "DiscoveredAt": {
                    "description": "DiscoveredAt sets date of discovery, provided by source or inserted automatically on create",
                    "type": "string"
                },
                "Email": {
                    "type": "string"
                },
                "ImportEvent": {
                    "description": "ImportEvent describes import session from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                        }
                    ]
                },
                "ImportEventID": {
                    "type": "integer"
                },
                "Source": {
                    "description": "Defines source from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistSource"
                        }
                    ]
                },
                "SourceID": {
                    "type": "integer"
                },
                "UUID": {
                    "type": "string"
                },
                "UpdatedAt": {
                    "type": "string"
                }
            }
        },
        "blacklistEntities.BlacklistedHost": {
            "type": "object",
            "properties": {
                "CreatedAt": {
                    "type": "string"
                },
                "DeletedAt": {
                    "$ref": "#/definitions/gorm.DeletedAt"
                },
                "Description": {
                    "type": "string"
                },
                "DiscoveredAt": {
                    "description": "DiscoveredAt sets date of discovery, provided by source or inserted automatically on create",
                    "type": "string"
                },
                "Host": {
                    "type": "string"
                },
                "ImportEvent": {
                    "description": "ImportEvent describes import session from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                        }
                    ]
                },
                "ImportEventID": {
                    "type": "integer"
                },
                "Source": {
                    "description": "Source defines source from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistSource"
                        }
                    ]
                },
                "SourceID": {
                    "type": "integer"
                },
                "Status": {
                    "$ref": "#/definitions/blacklistEntities.HostStatus"
                },
                "Type": {
                    "description": "domain, url or IP",
                    "type": "string"
                },
                "UUID": {
                    "type": "string"
                },
                "UpdatedAt": {
                    "type": "string"
                }
            }
        },
        "blacklistEntities.BlacklistedIP": {
            "type": "object",
            "properties": {
                "CreatedAt": {
                    "type": "string"
                },
                "DeletedAt": {
                    "$ref": "#/definitions/gorm.DeletedAt"
                },
                "Description": {
                    "type": "string"
                },
                "DiscoveredAt": {
                    "description": "DiscoveredAt sets date of discovery, provided by source or inserted automatically on create",
                    "type": "string"
                },
                "IPAddress": {
                    "$ref": "#/definitions/pgtype.Inet"
                },
                "ImportEvent": {
                    "description": "ImportEvent describes import session from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                        }
                    ]
                },
                "ImportEventID": {
                    "type": "integer"
                },
                "Source": {
                    "description": "Defines source from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistSource"
                        }
                    ]
                },
                "SourceID": {
                    "type": "integer"
                },
                "UUID": {
                    "type": "string"
                },
                "UpdatedAt": {
                    "type": "string"
                }
            }
        },
        "blacklistEntities.BlacklistedURL": {
            "type": "object",
            "properties": {
                "CreatedAt": {
                    "type": "string"
                },
                "DeletedAt": {
                    "$ref": "#/definitions/gorm.DeletedAt"
                },
                "Description": {
                    "type": "string"
                },
                "DiscoveredAt": {
                    "description": "DiscoveredAt sets date of discovery, provided by source or inserted automatically on create",
                    "type": "string"
                },
                "ImportEvent": {
                    "description": "ImportEvent describes import session from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistImportEvent"
                        }
                    ]
                },
                "ImportEventID": {
                    "type": "integer"
                },
                "MD5": {
                    "type": "string"
                },
                "Source": {
                    "description": "Defines source from where blacklisted host was added",
                    "allOf": [
                        {
                            "$ref": "#/definitions/blacklistEntities.BlacklistSource"
                        }
                    ]
                },
                "SourceID": {
                    "type": "integer"
                },
                "URL": {
                    "type": "string"
                },
                "UUID": {
                    "type": "string"
                },
                "UpdatedAt": {
                    "type": "string"
                }
            }
        },
        "blacklistEntities.HostStatus": {
            "type": "string",
            "enum": [
                "new"
            ],
            "x-enum-varnames": [
                "HostStatusNew"
            ]
        },
        "datatypes.JSONType-blacklistEntities_BlacklistImportEventSummary": {
            "type": "object"
        },
        "error.APIError": {
            "type": "object",
            "properties": {
                "ErrorCode": {
                    "$ref": "#/definitions/error.CodeError"
                },
                "ErrorMessage": {
                    "type": "string"
                },
                "ErrorModule": {
                    "type": "string"
                },
                "StatusCode": {
                    "type": "integer"
                }
            }
        },
        "error.CodeError": {
            "type": "integer",
            "enum": [
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11
            ],
            "x-enum-varnames": [
                "EncodingErrorCode",
                "DecodingErrorCode",
                "IncorrectParamsErrorCode",
                "InsufficientParamsErrorCode",
                "DatabaseErrorCode",
                "FileDecodingErrorCode",
                "FileReadingErrorCode",
                "FileExtensionNotSupportedErrorCode",
                "NotImplementedErrorCode",
                "FileProcessingErrorCode",
                "InternalUnidentifiedErrorCode"
            ]
        },
        "gorm.DeletedAt": {
            "type": "object",
            "properties": {
                "time": {
                    "type": "string"
                },
                "valid": {
                    "description": "Valid is true if Time is not NULL",
                    "type": "boolean"
                }
            }
        },
        "net.IPNet": {
            "type": "object",
            "properties": {
                "ip": {
                    "description": "network number",
                    "type": "array",
                    "items": {
                        "type": "integer"
                    }
                },
                "mask": {
                    "description": "network mask",
                    "type": "array",
                    "items": {
                        "type": "integer"
                    }
                }
            }
        },
        "pgtype.Inet": {
            "type": "object",
            "properties": {
                "ipnet": {
                    "$ref": "#/definitions/net.IPNet"
                },
                "status": {
                    "$ref": "#/definitions/pgtype.Status"
                }
            }
        },
        "pgtype.Status": {
            "type": "integer",
            "enum": [
                0,
                1,
                2
            ],
            "x-enum-varnames": [
                "Undefined",
                "Null",
                "Present"
            ]
        },
        "routing.BlacklistedStatistics": {
            "type": "object",
            "properties": {
                "ByDate": {
                    "type": "object",
                    "properties": {
                        "Dates": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        },
                        "Domains": {
                            "type": "array",
                            "items": {
                                "type": "integer"
                            }
                        },
                        "Emails": {
                            "type": "array",
                            "items": {
                                "type": "integer"
                            }
                        },
                        "IPs": {
                            "type": "array",
                            "items": {
                                "type": "integer"
                            }
                        },
                        "URLs": {
                            "type": "array",
                            "items": {
                                "type": "integer"
                            }
                        }
                    }
                },
                "LastEval": {
                    "type": "string"
                },
                "TotalDomains": {
                    "type": "integer"
                },
                "TotalEmails": {
                    "type": "integer"
                },
                "TotalIPs": {
                    "type": "integer"
                },
                "TotalURLs": {
                    "type": "integer"
                }
            }
        },
        "routing.blacklistInsertParams": {
            "type": "object",
            "required": [
                "hosts"
            ],
            "properties": {
                "hosts": {
                    "description": "issue: https://github.com/gin-gonic/gin/issues/3436",
                    "type": "array",
                    "minItems": 1,
                    "items": {
                        "type": "object",
                        "required": [
                            "host",
                            "source_id"
                        ],
                        "properties": {
                            "description": {
                                "type": "string"
                            },
                            "host": {
                                "type": "string"
                            },
                            "source_id": {
                                "type": "integer"
                            }
                        }
                    }
                }
            }
        },
        "routing.deleteByIDParams": {
            "type": "object",
            "required": [
                "ID"
            ],
            "properties": {
                "ID": {
                    "type": "integer"
                }
            }
        },
        "routing.deleteByUUIDParams": {
            "type": "object",
            "required": [
                "UUID"
            ],
            "properties": {
                "UUID": {
                    "type": "string"
                }
            }
        },
        "routing.dynamicConfigUpdateParams": {
            "type": "object",
            "required": [
                "DynamicConfigVariable"
            ],
            "properties": {
                "DynamicConfigValue": {
                    "type": "string"
                },
                "DynamicConfigVariable": {
                    "type": "string"
                }
            }
        },
        "serviceDeskEntities.ServiceDeskTicket": {
            "type": "object",
            "properties": {
                "CreatedAt": {
                    "type": "string"
                },
                "Data": {
                    "type": "array",
                    "items": {
                        "type": "integer"
                    }
                },
                "DeletedAt": {
                    "$ref": "#/definitions/gorm.DeletedAt"
                },
                "ID": {
                    "type": "integer"
                },
                "System": {
                    "type": "string"
                },
                "TicketID": {
                    "description": "TicketID is issued by service desk",
                    "type": "string"
                },
                "UpdatedAt": {
                    "type": "string"
                }
            }
        },
        "success.DatabaseResponse": {
            "type": "object",
            "properties": {
                "RowsAffected": {
                    "type": "integer"
                },
                "StatusCode": {
                    "type": "integer"
                },
                "Warnings": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        }
    }
}